<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
	<title>Vehicle - Car Rental</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css')}}" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800&amp;display=swap" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/swiper-icons.css')}}" />
	<link rel="stylesheet" href="{{ url_for('static', filename='fonts/fontawesome-all.min.css')}}" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/Filter.css')}}" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/Hero-Features-icons.css')}}" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.5.0/font/bootstrap-icons.min.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/css/theme.bootstrap_4.min.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/Ludens---Index-v2-with-Backend--Frontend-Filters.css')}}" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/Projects-Grid-images.css')}}" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/Simple-Slider-swiper-bundle.min.css')}}" />
	<link rel="stylesheet" href="{{ url_for('static', filename='css/Simple-Slider.css')}}" /> </head>

<body style="background: #cddddd;">
	<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
	<nav class="navbar navbar-expand-md sticky-top navbar-shrink py-3" id="mainNav">
		<div class="container"><a class="navbar-brand d-flex align-items-center" href="/products"><span class="bs-icon-lg bs-icon-circle bs-icon-primary shadow d-flex justify-content-center align-items-center me-2 bs-icon" style="background: #A599B5;"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-car-suv">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
              <path d="M5 17a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
              <path d="M16 17a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
              <path d="M5 9l2 -4h7.438a2 2 0 0 1 1.94 1.515l.622 2.485h3a2 2 0 0 1 2 2v3"></path>
              <path d="M10 9v-4"></path>
              <path d="M2 7v4"></path>
              <path d="M22.001 14.001a4.992 4.992 0 0 0 -4.001 -2.001a4.992 4.992 0 0 0 -4 2h-3a4.998 4.998 0 0 0 -8.003 .003"></path>
              <path d="M5 12v-3h13"></path>
          </svg></span><span style="font-size: 40px;font-weight: bold;text-align: center;--bs-dark: #2e2f2f;--bs-dark-rgb: 46,47,47;">Car Rental Service</span></a>
			<button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-1"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
			<div class="collapse navbar-collapse" id="navcol-1">
				<ul class="navbar-nav mx-auto">
					<li class="nav-item"></li>
					<li class="nav-item"></li>
					<li class="nav-item"></li>
					<li class="nav-item"></li>
				</ul>
				<a class="btn btn-secondary shadow" role="button" id="cartbutton" style="--bs-primary: #A599B5;--bs-primary-rgb: 165,153,181;--bs-secondary: #ACBDBA;--bs-secondary-rgb: 172,189,186;background: #acbdba;border-style: none;margin-right: 10px;" href="/cart">
					<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-cart-fill">
						<path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"></path>
					</svg>
				</a>
				{{ admin }}
				<a href="/pickupdropoff">
					<button class="btn btn-primary shadow" type="button" style="margin-right: 10px;">Pickup / Drop Off</button>
				</a>
				<a href="/logout">
					<button class="btn btn-danger shadow" type="button">Logout</button>
				</a>
			</div>
		</div>
	</nav>
    <h1
      style="text-align: center;background: #ffffff;padding-top: 20px;padding-bottom: 20px;font-size: 65px;padding-left: 38px;font-weight: bold;"
    >
      {{ year }} {{ make }} {{ model }}
      <form action="{{ url_for('addToCart') }}" method="POST">
        <input type="hidden" name="vehicleID" value="{{ vehicleID }}" />
        <input
          type="text"
          name="daterange"
          value=""
          style="font-size: 2rem;"
        /><br />
        <button
          class="btn btn-primary"
          type="submit"
          style="background: var(--bs-success);margin-bottom: 8px;"
        >
          Add to Cart
        </button>
      </form>
    </h1>
    <section style="margin-top: -8px;">
      <div class="simple-slider">
        <div class="swiper-container">
          <div class="swiper-wrapper" style="min-height: 800px;">
            {{ image_section }}
          </div>
          <div class="swiper-pagination"></div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-button-next"></div>
        </div>
        <div
          class="container h-100 position-relative"
          style="top: -50px; z-index: 2;"
        >
          <div class="row gy-5 gy-lg-0 row-cols-1 row-cols-md-2 row-cols-lg-3">
            <div class="col">
              <div class="card">
                <div class="card-body pt-5 p-4">
                  <h4 class="card-title">Key Features</h4>
                  <ul class="list-unstyled">
                    {{ features_section }}
                  </ul>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card">
                <div class="card-body pt-5 p-4">
                  <h4 class="card-title">Description</h4>
                  {{ description_section }}
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card">
                <div class="card-body pt-5 p-4">
                  <h4 class="card-title">Current Location</h4>
                  <div>{{ map_section }}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <footer
      class="bg-primary-gradient"
      style="position: static;left: 0;bottom: 0;color: rgba(255,255,255,0);text-align: center;width: 100%;"
    >
      <div
        class="container py-4 py-lg-5"
        style="--bs-secondary: #A599B5;--bs-secondary-rgb: 165,153,181;"
      >
        <hr />
        <div
          class="text-muted d-flex justify-content-between align-items-center pt-3"
        >
          <p class="mb-0" style="margin: auto;">Copyright Â© 2024 Car Rental</p>
        </div>
      </div>
    </footer>
    <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.min.js')}}"></script>
    <script src="{{ url_for('static', filename='js/bs-init.js')}}"></script>
    <script src="{{ url_for('static', filename='/js/bold-and-bright.js')}}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/js/widgets/widget-storage.min.js')}}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js')}}"></script>
    <script src="{{ url_for('static', filename='js/Ludens---Index-v2-with-Backend--Frontend-Filters-Ludens---1-Index-Table-with-Search--Sort-Filters-v20-1.js')}}"></script>
    <script src="{{ url_for('static', filename='js/Ludens---Index-v2-with-Backend--Frontend-Filters-Ludens---1-Index-Table-with-Search--Sort-Filters-v20.js')}}"></script>
    <script src="{{ url_for('static', filename='js/Simple-Slider-swiper-bundle.min.js')}}"></script>
    <script src="{{ url_for('static', filename='js/Simple-Slider.js')}}"></script>
    <script src="{{ url_for('static', filename='js/theme.js')}}"></script>
    <script>
        $(function() {
            // Example of reserved dates (pass this dynamically from your backend)
            var reservedDates = {{ reserved_dates|safe }};
    
            // Function to check if a single date is reserved
            function isDateReserved(date) {
                return reservedDates.includes(date.format('YYYY-MM-DD'));
            }
    
            // Function to find the next available date range of 2 days
            function getNextAvailableRange(startDate) {
                let currentStart = startDate.clone();
                while (isDateReserved(currentStart) || isDateReserved(currentStart.clone().add(1, 'days'))) {
                    currentStart.add(1, 'days'); // Move to the next day
                }
                return {
                    start: currentStart,
                    end: currentStart.clone().add(1, 'days') // Default range is 2 days
                };
            }
    
            // Determine the default start and end dates
            let start = moment();
            let end = moment().add(1, 'days');
    
            // Check if the current date is reserved
            if (isDateReserved(start) || isDateReserved(end)) {
                let nextRange = getNextAvailableRange(start);
                start = nextRange.start;
                end = nextRange.end;
            }
    
            // Initialize the date range picker
            $('input[name="daterange"]').daterangepicker({
                opens: 'left',
                startDate: start,
                endDate: end,
                isInvalidDate: function(date) {
                    return date.isBefore(moment(), 'day') || isDateReserved(date); // Disable past and reserved dates
                }
            }, function(start, end, label) {
                // Function to handle selected range
                let rangeStart = start.clone();
                let rangeEnd = end.clone();
    
                // Check if the selected range overlaps with reserved dates
                let isOverlap = false;
                while (rangeStart.isSameOrBefore(rangeEnd)) {
                    if (isDateReserved(rangeStart)) {
                        isOverlap = true;
                        break;
                    }
                    rangeStart.add(1, 'days');
                }
    
                if (isOverlap) {
                    alert("Error: Selected range overlaps with reserved dates. Please select a different range.");
                    // Refresh the page to reset the date range picker
                    window.location.reload();
                } else {
                    console.log("Valid date range selected: " + start.format('YYYY-MM-DD') + " to " + end.format('YYYY-MM-DD'));
                }
            });
    
            // Set the initial value of the input to show the default date range
            $('input[name="daterange"]').val(start.format('MM/DD/YYYY') + ' - ' + end.format('MM/DD/YYYY'));
        });
    </script>
  </body>
</html>